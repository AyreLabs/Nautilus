
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>360&deg; Image</title>
    <meta name="description" content="360&deg; Image - A-Frame">
    <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  </head>
  <body>
    <script>
    //------------------------------------------------------------------------------------------
    // Web Socket Streaming    
    //------------------------------------------------------------------------------------------
    var ws = new WebSocket('ws://127.0.0.1:3000');
    latestText = "Default Text";
    ws.onopen = function(){
        console.log('Connected to 127.0.0.1:3000!');
    }
    ws.addEventListener("message", function(event) {
        console.log('Received: ' + event.data);
        //latestText = event.data;
        var im = document.getElementById("my-text");
        im.setAttribute('value', event.data);
    });
    function getLatestText () {
        return latestText;
    }
  //------------------------------------------------------------------------------------------
  // Custom Entity
  //------------------------------------------------------------------------------------------
  AFRAME.registerComponent('set-sky', {
    schema: {default:''},
    init: function() {
      this.timeout = setInterval(this.updateSky.bind(this), 300);
      this.sky = this.el;
    },
    remove: function() {
      clearInterval(this.timeout);
      this.el.removeObject3D(this.object3D);
    },
    updateSky: function() {
        //this.sky.setAttribute( 'src', imsrc);
        //document.querySelector('#my-image').setAttribute('src', imsrc)
        var sceneEl = document.querySelector('a-scene');
        var im = sceneEl.querySelector('#my-text');
        //this.sky.setAttribute( 'src', this.data + "?" + Math.random());
        var gottedTextValue = getLatestText();
        im.setAttribute( 'value', "HELLO");
        //im.setAttribute( 'value', gottedTextValue);
    }
  });
  //------------------------------------------------------------------------------------------
    </script>

    <a-scene>
      <a-assets>
        <img id="city" crossorigin="anonymous" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg">
      </a-assets>

      <a-sky src="#city" rotation="0 -130 0"></a-sky>
      <a-text id="my-text" font="kelsonsans" value="Puy de Sancy, France" width="6" position="-2.5 0.25 -1.5"
              rotation="0 15 0"></a-text>
    </a-scene>
  </body>
</html>

<!-- 

  public static String nautilusRoomTerminalPositionStateUpdateMessageWithTerminalIDPositionXYZAndRotationXYZ(int terminalID, double positionX, double positionY, double positionZ, double rotationX, double rotationY, double rotationZ) {
      return String.format("Q%d:%lf,%lf,%lf,%lf,%lf,%lf", terminalID, positionX, positionY, positionZ, rotationX, rotationY, rotationZ);
  }

  public static String nautilusRoomTerminalDisplayStateUpdateMessageWithTerminalIDAndDisplayString(int terminalID, String displayString) {
      return String.format("Z%d:%s", terminalID, displayString);
  }

-->
